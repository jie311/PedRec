# PedRecNet2D
## Trial Name
**experiment_pedrec_p2d3d_c_h36m_sim**
## Initialization
| Network Part                   | Initialization                                               |
| ------------------------------ | ------------------------------------------------------------ |
| net.model.feature_extractor    | TODO                                                         |
| net.model.conv_transpose_shared | TODO                                                         |
| net.model.head_pose_2d         | TODO                                                         |
| net.model.head_pose_3d         | TODO                                                         |
| net.model.head_orientation     | TODO                                                         |
| net.model.head_conf            | TODO                                                         |
Notes. Initialized from p2d3d_c_h36m
## Datasets
### Training
| Dataset                   | Subsampling | Full set length | Used length |
| ------------------------- | ----------- | --------------- | ----------- |
| COCO (TRAIN)              | 1           | 149813          | 149813      |
| rt_rom_01b.pkl            | 1           | 147729          | 147729      |
| rt_validate_3d.pkl        | 1           | 39484           | 39484       |
| h36m_train_pedrec.pkl     | 10          | 155976          | 155976      |
### Validation
| Dataset                   | Subsampling | Full set length | Used length |
| ------------------------- | ----------- | --------------- | ----------- |
| COCO (VAL)                | 1           | 6352            | 6352        |
| rt_validate_3d.pkl        | 10          | 3949            | 3949        |
| h36m_val_pedrec.pkl       | 64          | 8604            | 8604        |
## Augmentation
### Training Augmentations - COCO
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 30                        |
### Training Augmentations - SIM
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 0                         |
### Training Augmentations - H36M
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 0                         |
## General data preparation
```python
trans = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
])
```
suggested lr: 2.08e-03
## Round 0
- Epochs: **10**
- LR Scheduler: **OneCycleLR**
### Optimizer
| Property                  | Value                     |
| ------------------------- | ------------------------- |
| name                      | AdamW                     |
| lr                        | 0.001                     |
| betas                     | (0.9, 0.999)              |
| eps                       | 1e-08                     |
| weight_decay              | 0.01                      |
| amsgrad                   | False                     |
### LRs
| Network Part              | LRs                  | Frozen? |
| ------------------------- | -------------------- | ------- |
| net.model.feature_extractor | 2.08e-03, 2.08e-03   | True    |
| net.model.conv_transpose_shared | 2.08e-03, 2.08e-03   | False   |
| net.model.head_pose_2d    | 2.08e-03, 2.08e-03   | False   |
| net.model.head_pose_3d    | 2.08e-03, 2.08e-03   | False   |
| net.model.head_orientation | 0.00e+00, 0.00e+00   | False   |
| net.model.head_conf       | 2.08e-03, 2.08e-03   | False   |
### Results
| Epoch | Train Loss | COCO PCK@0.05 | COCO PCK@0.2 | COCO JointAcc | COCO Val Loss | COCO Val Time | SIM PCK@0.05 | SIM PCK@0.2 | SIM MPJPE | SIM MRCJP | SIM MRCD | SIM JointAcc | SIM Val Loss | SIM Val Time | H36M PCK@0.05 | H36M PCK@0.2 | H36M MPJPE | H36M MRCJP | H36M MRCD | H36M JointAcc | H36M Val Loss | H36M Val Time | Train Time |
| ----- | ---------- | ------------- | ------------ | ------------- | ------------- | ------------- | ------------ | ----------- | --------- | --------- | -------- | ------------ | ------------ | ------------ | ------------- | ------------ | ---------- | ---------- | --------- | ------------- | ------------- | ------------- | ---------- |
| 0     | 0.19190    | 52.24         | 91.54        | 0.88          | 0.4995        | 0:00:12       | 63.66        | 98.96       | 70.34     | 0.64      | 0.84     | 1.00         | 0.1265       | 0:00:11      | 58.15         | 92.29        | 68.40      | 0.78       | 0.92      | 1.00          | 0.1404        | 0:00:16       | 0:30:16    |
| 1     | 0.15301    | 52.07         | 91.55        | 0.87          | 0.4894        | 0:00:12       | 72.84        | 99.42       | 53.62     | 0.69      | 0.87     | 1.00         | 0.1060       | 0:00:10      | 57.42         | 92.23        | 71.91      | 0.77       | 0.91      | 1.00          | 0.1392        | 0:00:16       | 0:29:33    |
| 2     | 0.14812    | 52.21         | 91.51        | 0.85          | 0.5100        | 0:00:12       | 78.32        | 99.60       | 44.94     | 0.71      | 0.88     | 1.00         | 0.0974       | 0:00:10      | 58.45         | 92.28        | 68.06      | 0.78       | 0.91      | 1.00          | 0.1390        | 0:00:16       | 0:30:39    |
| 3     | 0.14361    | 52.29         | 91.66        | 0.86          | 0.5086        | 0:00:11       | 80.76        | 99.70       | 40.42     | 0.73      | 0.88     | 1.00         | 0.0938       | 0:00:11      | 58.53         | 92.19        | 69.05      | 0.78       | 0.92      | 1.00          | 0.1418        | 0:00:16       | 0:30:30    |
| 4     | 0.13894    | 52.47         | 91.64        | 0.86          | 0.5070        | 0:00:12       | 82.62        | 99.74       | 36.50     | 0.75      | 0.90     | 1.00         | 0.0912       | 0:00:10      | 58.99         | 92.20        | 68.09      | 0.78       | 0.92      | 1.00          | 0.1430        | 0:00:16       | 0:30:36    |
| 5     | 0.13415    | 52.43         | 91.56        | 0.87          | 0.4900        | 0:00:12       | 84.83        | 99.80       | 33.85     | 0.76      | 0.90     | 1.00         | 0.0835       | 0:00:11      | 58.62         | 92.35        | 68.42      | 0.78       | 0.92      | 1.00          | 0.1403        | 0:00:16       | 0:30:33    |
| 6     | 0.12933    | 52.72         | 91.66        | 0.88          | 0.4912        | 0:00:11       | 85.63        | 99.83       | 31.86     | 0.77      | 0.91     | 1.00         | 0.0818       | 0:00:10      | 59.53         | 92.37        | 66.39      | 0.79       | 0.92      | 1.00          | 0.1386        | 0:00:16       | 0:29:56    |
| 7     | 0.12522    | 52.70         | 91.67        | 0.88          | 0.4832        | 0:00:11       | 86.46        | 99.85       | 30.27     | 0.78      | 0.92     | 1.00         | 0.0787       | 0:00:11      | 59.82         | 92.39        | 66.88      | 0.79       | 0.92      | 1.00          | 0.1378        | 0:00:16       | 0:29:04    |
| 8     | 0.12232    | 52.99         | 91.72        | 0.88          | 0.4786        | 0:00:11       | 86.87        | 99.85       | 29.46     | 0.78      | 0.92     | 1.00         | 0.0771       | 0:00:11      | 59.39         | 92.45        | 66.38      | 0.79       | 0.92      | 1.00          | 0.1372        | 0:00:16       | 0:29:32    |
| 9     | 0.12081    | 52.90         | 91.71        | 0.89          | 0.4779        | 0:00:11       | 86.98        | 99.86       | 29.19     | 0.78      | 0.92     | 1.00         | 0.0767       | 0:00:10      | 59.48         | 92.40        | 66.21      | 0.79       | 0.92      | 1.00          | 0.1372        | 0:00:16       | 0:29:03    |
## Round 1
- Epochs: **5**
- LR Scheduler: **OneCycleLR**
### Optimizer
| Property                  | Value                     |
| ------------------------- | ------------------------- |
| name                      | AdamW                     |
| lr                        | 0.001                     |
| betas                     | (0.9, 0.999)              |
| eps                       | 1e-08                     |
| weight_decay              | 0.01                      |
| amsgrad                   | False                     |
### LRs
| Network Part              | LRs                  | Frozen? |
| ------------------------- | -------------------- | ------- |
| net.model.feature_extractor | 1.04e-04, 1.04e-04   | False   |
| net.model.conv_transpose_shared | 2.08e-04, 2.08e-04   | False   |
| net.model.head_pose_2d    | 2.08e-04, 2.08e-04   | False   |
| net.model.head_pose_3d    | 2.08e-04, 2.08e-04   | False   |
| net.model.head_orientation | 0.00e+00, 0.00e+00   | False   |
| net.model.head_conf       | 2.08e-04, 2.08e-04   | False   |
### Results
| Epoch | Train Loss | COCO PCK@0.05 | COCO PCK@0.2 | COCO JointAcc | COCO Val Loss | COCO Val Time | SIM PCK@0.05 | SIM PCK@0.2 | SIM MPJPE | SIM MRCJP | SIM MRCD | SIM JointAcc | SIM Val Loss | SIM Val Time | H36M PCK@0.05 | H36M PCK@0.2 | H36M MPJPE | H36M MRCJP | H36M MRCD | H36M JointAcc | H36M Val Loss | H36M Val Time | Train Time |
| ----- | ---------- | ------------- | ------------ | ------------- | ------------- | ------------- | ------------ | ----------- | --------- | --------- | -------- | ------------ | ------------ | ------------ | ------------- | ------------ | ---------- | ---------- | --------- | ------------- | ------------- | ------------- | ---------- |
| 0     | 0.11948    | 52.84         | 91.65        | 0.89          | 0.4790        | 0:00:11       | 89.03        | 99.91       | 27.43     | 0.79      | 0.92     | 1.00         | 0.0741       | 0:00:11      | 59.61         | 92.44        | 66.50      | 0.79       | 0.92      | 1.00          | 0.1387        | 0:00:16       | 0:34:15    |
| 1     | 0.11815    | 52.89         | 91.66        | 0.89          | 0.4799        | 0:00:11       | 90.68        | 99.96       | 25.67     | 0.80      | 0.93     | 1.00         | 0.0714       | 0:00:10      | 59.96         | 92.50        | 66.17      | 0.79       | 0.92      | 1.00          | 0.1386        | 0:00:16       | 0:34:17    |
| 2     | 0.11564    | 53.13         | 91.67        | 0.89          | 0.4810        | 0:00:12       | 91.67        | 99.97       | 24.08     | 0.81      | 0.93     | 1.00         | 0.0693       | 0:00:11      | 60.08         | 92.52        | 64.96      | 0.79       | 0.92      | 1.00          | 0.1391        | 0:00:16       | 0:35:35    |
| 3     | 0.11315    | 53.19         | 91.78        | 0.89          | 0.4770        | 0:00:11       | 92.28        | 99.97       | 23.16     | 0.81      | 0.93     | 1.00         | 0.0679       | 0:00:11      | 60.49         | 92.56        | 65.03      | 0.79       | 0.92      | 1.00          | 0.1395        | 0:00:16       | 0:34:44    |
| 4     | 0.11155    | 53.22         | 91.77        | 0.89          | 0.4765        | 0:00:12       | 92.41        | 99.97       | 22.89     | 0.81      | 0.93     | 1.00         | 0.0673       | 0:00:10      | 60.51         | 92.56        | 65.26      | 0.79       | 0.92      | 1.00          | 0.1397        | 0:00:16       | 0:34:59    |
