# PedRecNet2D
## Trial Name
**experiment_pedrec_p2d3d_h36m_sim**
## Initialization
| Network Part                   | Initialization                                               |
| ------------------------------ | ------------------------------------------------------------ |
| net.model.feature_extractor    | TODO                                                         |
| net.model.conv_transpose_shared | TODO                                                         |
| net.model.head_pose_2d         | TODO                                                         |
| net.model.head_pose_3d         | TODO                                                         |
| net.model.head_orientation     | TODO                                                         |
| net.model.head_conf            | TODO                                                         |
Notes. Initialized from p2d3d_h36m
## Datasets
### Training
| Dataset                   | Subsampling | Full set length | Used length |
| ------------------------- | ----------- | --------------- | ----------- |
| COCO (TRAIN)              | 1           | 149813          | 149813      |
| rt_rom_01b.pkl            | 1           | 147729          | 147729      |
| rt_validate_3d.pkl        | 1           | 39484           | 39484       |
| h36m_train_pedrec.pkl     | 10          | 155976          | 155976      |
### Validation
| Dataset                   | Subsampling | Full set length | Used length |
| ------------------------- | ----------- | --------------- | ----------- |
| COCO (VAL)                | 1           | 6352            | 6352        |
| rt_validate_3d.pkl        | 10          | 3949            | 3949        |
| h36m_val_pedrec.pkl       | 64          | 8604            | 8604        |
## Augmentation
### Training Augmentations - COCO
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 30                        |
### Training Augmentations - SIM
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 0                         |
### Training Augmentations - H36M
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 0                         |
## General data preparation
```python
trans = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
])
```
suggested lr: 2.08e-03
## Round 0
- Epochs: **10**
- LR Scheduler: **OneCycleLR**
### Optimizer
| Property                  | Value                     |
| ------------------------- | ------------------------- |
| name                      | AdamW                     |
| lr                        | 0.001                     |
| betas                     | (0.9, 0.999)              |
| eps                       | 1e-08                     |
| weight_decay              | 0.01                      |
| amsgrad                   | False                     |
### LRs
| Network Part              | LRs                  | Frozen? |
| ------------------------- | -------------------- | ------- |
| net.model.feature_extractor | 2.08e-03, 2.08e-03   | True    |
| net.model.conv_transpose_shared | 2.08e-03, 2.08e-03   | False   |
| net.model.head_pose_2d    | 2.08e-03, 2.08e-03   | False   |
| net.model.head_pose_3d    | 2.08e-03, 2.08e-03   | False   |
| net.model.head_orientation | 0.00e+00, 0.00e+00   | False   |
| net.model.head_conf       | 0.00e+00, 0.00e+00   | False   |
### Results
| Epoch | Train Loss | COCO PCK@0.05 | COCO PCK@0.2 | COCO Val Loss | COCO Val Time | SIM PCK@0.05 | SIM PCK@0.2 | SIM MPJPE | SIM MRCJP | SIM MRCD | SIM Val Loss | SIM Val Time | H36M PCK@0.05 | H36M PCK@0.2 | H36M MPJPE | H36M MRCJP | H36M MRCD | H36M Val Loss | H36M Val Time | Train Time |
| ----- | ---------- | ------------- | ------------ | ------------- | ------------- | ------------ | ----------- | --------- | --------- | -------- | ------------ | ------------ | ------------- | ------------ | ---------- | ---------- | --------- | ------------- | ------------- | ---------- |
| 0     | 0.10320    | 52.42         | 91.78        | 0.2210        | 0:00:35       | 63.35        | 98.94       | 71.17     | 0.63      | 0.84     | 0.0876       | 0:00:24      | 58.32         | 92.33        | 68.09      | 0.78       | 0.92      | 0.0971        | 0:00:47       | 1:36:16    |
| 1     | 0.08412    | 51.98         | 91.58        | 0.2221        | 0:00:34       | 73.19        | 99.46       | 53.67     | 0.68      | 0.86     | 0.0751       | 0:00:24      | 57.69         | 92.17        | 70.29      | 0.77       | 0.92      | 0.0988        | 0:00:46       | 1:36:14    |
| 2     | 0.07942    | 52.23         | 91.67        | 0.2240        | 0:00:34       | 77.88        | 99.62       | 45.91     | 0.71      | 0.87     | 0.0691       | 0:00:24      | 58.15         | 92.22        | 71.34      | 0.77       | 0.92      | 0.0999        | 0:00:46       | 1:36:15    |
| 3     | 0.07635    | 52.38         | 91.70        | 0.2235        | 0:00:34       | 80.39        | 99.72       | 39.86     | 0.73      | 0.89     | 0.0649       | 0:00:23      | 57.30         | 92.16        | 69.01      | 0.78       | 0.92      | 0.0988        | 0:00:46       | 1:36:15    |
| 4     | 0.07383    | 52.46         | 91.71        | 0.2205        | 0:00:34       | 82.80        | 99.75       | 36.62     | 0.74      | 0.89     | 0.0616       | 0:00:24      | 58.53         | 92.25        | 69.31      | 0.78       | 0.91      | 0.0996        | 0:00:46       | 1:36:15    |
| 5     | 0.07164    | 52.68         | 91.75        | 0.2227        | 0:00:34       | 84.23        | 99.80       | 33.96     | 0.76      | 0.91     | 0.0595       | 0:00:24      | 58.75         | 92.37        | 68.35      | 0.78       | 0.92      | 0.0990        | 0:00:46       | 1:36:15    |
| 6     | 0.06965    | 52.96         | 91.79        | 0.2244        | 0:00:34       | 85.68        | 99.81       | 32.22     | 0.77      | 0.91     | 0.0579       | 0:00:24      | 59.32         | 92.36        | 67.88      | 0.78       | 0.92      | 0.0989        | 0:00:46       | 1:36:15    |
| 7     | 0.06800    | 53.00         | 91.78        | 0.2227        | 0:00:34       | 86.39        | 99.83       | 30.45     | 0.78      | 0.92     | 0.0563       | 0:00:24      | 59.39         | 92.46        | 65.97      | 0.79       | 0.92      | 0.0982        | 0:00:46       | 1:36:14    |
| 8     | 0.06675    | 53.05         | 91.79        | 0.2219        | 0:00:34       | 86.67        | 99.84       | 29.63     | 0.78      | 0.92     | 0.0555       | 0:00:24      | 59.17         | 92.44        | 66.40      | 0.79       | 0.92      | 0.0988        | 0:00:46       | 1:36:15    |
| 9     | 0.06621    | 52.92         | 91.81        | 0.2233        | 0:00:34       | 86.87        | 99.84       | 29.43     | 0.78      | 0.92     | 0.0554       | 0:00:23      | 59.06         | 92.42        | 66.41      | 0.79       | 0.92      | 0.0990        | 0:00:46       | 1:36:15    |
## Round 1
- Epochs: **5**
- LR Scheduler: **OneCycleLR**
### Optimizer
| Property                  | Value                     |
| ------------------------- | ------------------------- |
| name                      | AdamW                     |
| lr                        | 0.001                     |
| betas                     | (0.9, 0.999)              |
| eps                       | 1e-08                     |
| weight_decay              | 0.01                      |
| amsgrad                   | False                     |
### LRs
| Network Part              | LRs                  | Frozen? |
| ------------------------- | -------------------- | ------- |
| net.model.feature_extractor | 1.04e-04, 1.04e-04   | False   |
| net.model.conv_transpose_shared | 2.08e-04, 2.08e-04   | False   |
| net.model.head_pose_2d    | 2.08e-04, 2.08e-04   | False   |
| net.model.head_pose_3d    | 2.08e-04, 2.08e-04   | False   |
| net.model.head_orientation | 0.00e+00, 0.00e+00   | False   |
| net.model.head_conf       | 0.00e+00, 0.00e+00   | False   |
### Results
| Epoch | Train Loss | COCO PCK@0.05 | COCO PCK@0.2 | COCO Val Loss | COCO Val Time | SIM PCK@0.05 | SIM PCK@0.2 | SIM MPJPE | SIM MRCJP | SIM MRCD | SIM Val Loss | SIM Val Time | H36M PCK@0.05 | H36M PCK@0.2 | H36M MPJPE | H36M MRCJP | H36M MRCD | H36M Val Loss | H36M Val Time | Train Time |
| ----- | ---------- | ------------- | ------------ | ------------- | ------------- | ------------ | ----------- | --------- | --------- | -------- | ------------ | ------------ | ------------- | ------------ | ---------- | ---------- | --------- | ------------- | ------------- | ---------- |
| 0     | 0.06529    | 52.88         | 91.69        | 0.2231        | 0:00:34       | 89.18        | 99.91       | 27.52     | 0.79      | 0.92     | 0.0530       | 0:00:23      | 58.90         | 92.45        | 66.53      | 0.79       | 0.92      | 0.0994        | 0:00:46       | 1:53:47    |
| 1     | 0.06416    | 52.85         | 91.76        | 0.2226        | 0:00:34       | 90.65        | 99.95       | 25.43     | 0.80      | 0.93     | 0.0508       | 0:00:24      | 59.90         | 92.51        | 66.66      | 0.79       | 0.92      | 0.0998        | 0:00:46       | 1:53:47    |
| 2     | 0.06257    | 53.12         | 91.60        | 0.2224        | 0:00:34       | 91.62        | 99.96       | 24.04     | 0.81      | 0.93     | 0.0493       | 0:00:23      | 60.43         | 92.57        | 65.18      | 0.79       | 0.92      | 0.0989        | 0:00:46       | 1:53:47    |
| 3     | 0.06115    | 53.16         | 91.77        | 0.2221        | 0:00:34       | 92.19        | 99.96       | 23.17     | 0.81      | 0.93     | 0.0483       | 0:00:23      | 60.49         | 92.63        | 65.19      | 0.79       | 0.92      | 0.0993        | 0:00:46       | 1:53:46    |
| 4     | 0.06032    | 53.23         | 91.77        | 0.2220        | 0:00:34       | 92.28        | 99.96       | 22.94     | 0.81      | 0.93     | 0.0481       | 0:00:24      | 60.29         | 92.59        | 65.26      | 0.79       | 0.92      | 0.0996        | 0:00:46       | 1:53:48    |
