# PedRecNet2D
## Trial Name
**experiment_pedrec_p2d3d_c_o_h36m_sim_mebow**
## Initialization
| Network Part                   | Initialization                                               |
| ------------------------------ | ------------------------------------------------------------ |
| net.model.feature_extractor    | TODO                                                         |
| net.model.conv_transpose_shared | TODO                                                         |
| net.model.head_pose_2d         | TODO                                                         |
| net.model.head_pose_3d         | TODO                                                         |
| net.model.head_orientation     | TODO                                                         |
| net.model.head_conf            | TODO                                                         |
Notes. Initialized from p2d3d_c_o_h36m_sim
## Datasets
### Training
| Dataset                   | Subsampling | Full set length | Used length |
| ------------------------- | ----------- | --------------- | ----------- |
| COCO (TRAIN)              | 1           | 149813          | 149813      |
| rt_rom_01b.pkl            | 1           | 147729          | 147729      |
| rt_validate_3d.pkl        | 1           | 39484           | 39484       |
| h36m_train_pedrec.pkl     | 10          | 155976          | 155976      |
### Validation
| Dataset                   | Subsampling | Full set length | Used length |
| ------------------------- | ----------- | --------------- | ----------- |
| COCO (VAL)                | 1           | 6352            | 6352        |
| rt_validate_3d.pkl        | 10          | 3949            | 3949        |
| h36m_val_pedrec.pkl       | 64          | 8604            | 8604        |
## Augmentation
### Training Augmentations - COCO
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 0                         |
### Training Augmentations - SIM
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 0                         |
### Training Augmentations - H36M
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 0                         |
## General data preparation
```python
trans = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
])
```
suggested lr: 2.08e-03
## Round 0
- Epochs: **10**
- LR Scheduler: **OneCycleLR**
### Optimizer
| Property                  | Value                     |
| ------------------------- | ------------------------- |
| name                      | AdamW                     |
| lr                        | 0.001                     |
| betas                     | (0.9, 0.999)              |
| eps                       | 1e-08                     |
| weight_decay              | 0.01                      |
| amsgrad                   | False                     |
### LRs
| Network Part              | LRs                  | Frozen? |
| ------------------------- | -------------------- | ------- |
| net.model.feature_extractor | 2.08e-03, 2.08e-03   | True    |
| net.model.conv_transpose_shared | 2.08e-03, 2.08e-03   | False   |
| net.model.head_pose_2d    | 2.08e-03, 2.08e-03   | False   |
| net.model.head_pose_3d    | 2.08e-03, 2.08e-03   | False   |
| net.model.head_orientation | 2.08e-03, 2.08e-03   | False   |
| net.model.head_conf       | 2.08e-03, 2.08e-03   | False   |
### Results
| Epoch | Train Loss | COCO PCK@0.05 | COCO PCK@0.2 | COCO JointAcc | COCO Body Sph.Dist. | COCO Body.Phi.Ang.Dist. | COCO Head Sph.Dist. | COCO Head.Phi.Ang.Dist. | COCO Val Loss | COCO Val Time | SIM PCK@0.05 | SIM PCK@0.2 | SIM MPJPE | SIM MRCJP | SIM MRCD | SIM JointAcc | SIM Body Sph.Dist. | SIM Body.Phi.Ang.Dist. | SIM Head Sph.Dist. | SIM Head.Phi.Ang.Dist. | SIM Val Loss | SIM Val Time | H36M PCK@0.05 | H36M PCK@0.2 | H36M MPJPE | H36M MRCJP | H36M MRCD | H36M JointAcc | H36M Val Loss | H36M Val Time | Train Time |
| ----- | ---------- | ------------- | ------------ | ------------- | ------------------- | ----------------------- | ------------------- | ----------------------- | ------------- | ------------- | ------------ | ----------- | --------- | --------- | -------- | ------------ | ------------------ | ---------------------- | ------------------ | ---------------------- | ------------ | ------------ | ------------- | ------------ | ---------- | ---------- | --------- | ------------- | ------------- | ------------- | ---------- |
| 0     | 0.15773    | 53.36         | 91.73        | 0.89          | 0.00                | 0.36                    | 0.00                | 0.00                    | 0.6806        | 0:00:12       | 95.57        | 99.99       | 18.27     | 0.84      | 0.95     | 1.00         | 0.38               | 0.40                   | 0.53               | 0.54                   | 0.1544       | 0:00:11      | 60.59         | 92.58        | 64.51      | 0.79       | 0.92      | 1.00          | 0.1500        | 0:00:16       | 0:29:59    |
| 1     | 0.14724    | 53.07         | 91.63        | 0.86          | 0.00                | 0.21                    | 0.00                | 0.00                    | 0.6451        | 0:00:11       | 95.21        | 99.99       | 20.32     | 0.83      | 0.94     | 1.00         | 0.08               | 0.08                   | 0.13               | 0.12                   | 0.0924       | 0:00:10      | 60.37         | 92.51        | 64.98      | 0.79       | 0.92      | 1.00          | 0.1513        | 0:00:16       | 0:29:33    |
| 2     | 0.15051    | 53.23         | 91.67        | 0.87          | 0.00                | 0.20                    | 0.00                | 0.00                    | 0.6324        | 0:00:11       | 94.80        | 99.98       | 21.07     | 0.83      | 0.94     | 1.00         | 0.09               | 0.09                   | 0.12               | 0.11                   | 0.0934       | 0:00:10      | 60.41         | 92.49        | 66.09      | 0.79       | 0.92      | 1.00          | 0.1509        | 0:00:16       | 0:29:34    |
| 3     | 0.14998    | 53.24         | 91.65        | 0.87          | 0.00                | 0.20                    | 0.00                | 0.00                    | 0.6247        | 0:00:12       | 95.27        | 99.98       | 19.97     | 0.83      | 0.94     | 1.00         | 0.08               | 0.08                   | 0.11               | 0.10                   | 0.0892       | 0:00:10      | 60.56         | 92.53        | 67.39      | 0.79       | 0.92      | 1.00          | 0.1499        | 0:00:16       | 0:30:23    |
| 4     | 0.14666    | 53.25         | 91.67        | 0.87          | 0.00                | 0.20                    | 0.00                | 0.00                    | 0.6184        | 0:00:11       | 95.68        | 99.99       | 19.28     | 0.83      | 0.94     | 1.00         | 0.13               | 0.14                   | 0.14               | 0.14                   | 0.0982       | 0:00:10      | 60.26         | 92.54        | 64.57      | 0.79       | 0.92      | 1.00          | 0.1497        | 0:00:16       | 0:29:42    |
| 5     | 0.14215    | 53.37         | 91.69        | 0.88          | 0.00                | 0.19                    | 0.00                | 0.00                    | 0.5947        | 0:00:12       | 95.79        | 99.98       | 18.41     | 0.85      | 0.95     | 1.00         | 0.06               | 0.06                   | 0.13               | 0.12                   | 0.0892       | 0:00:10      | 60.44         | 92.58        | 65.04      | 0.79       | 0.92      | 1.00          | 0.1481        | 0:00:16       | 0:29:50    |
| 6     | 0.13661    | 53.53         | 91.81        | 0.88          | 0.00                | 0.19                    | 0.00                | 0.00                    | 0.5891        | 0:00:12       | 96.34        | 99.99       | 17.54     | 0.85      | 0.95     | 1.00         | 0.06               | 0.06                   | 0.09               | 0.09                   | 0.0804       | 0:00:10      | 60.53         | 92.49        | 65.17      | 0.79       | 0.92      | 1.00          | 0.1501        | 0:00:16       | 0:29:59    |
| 7     | 0.13298    | 53.59         | 91.72        | 0.88          | 0.00                | 0.19                    | 0.00                | 0.00                    | 0.5897        | 0:00:11       | 96.41        | 99.99       | 16.74     | 0.85      | 0.95     | 1.00         | 0.05               | 0.05                   | 0.08               | 0.08                   | 0.0766       | 0:00:10      | 60.87         | 92.61        | 65.13      | 0.79       | 0.92      | 1.00          | 0.1492        | 0:00:16       | 0:29:35    |
| 8     | 0.12980    | 53.65         | 91.76        | 0.88          | 0.00                | 0.18                    | 0.00                | 0.00                    | 0.5840        | 0:00:11       | 96.52        | 99.99       | 16.26     | 0.86      | 0.95     | 1.00         | 0.05               | 0.05                   | 0.07               | 0.07                   | 0.0742       | 0:00:10      | 60.82         | 92.59        | 64.35      | 0.79       | 0.92      | 1.00          | 0.1482        | 0:00:16       | 0:29:36    |
| 9     | 0.12837    | 53.53         | 91.75        | 0.88          | 0.00                | 0.18                    | 0.00                | 0.00                    | 0.5826        | 0:00:11       | 96.60        | 99.99       | 16.10     | 0.86      | 0.95     | 1.00         | 0.05               | 0.05                   | 0.07               | 0.06                   | 0.0733       | 0:00:11      | 60.90         | 92.62        | 64.50      | 0.79       | 0.92      | 1.00          | 0.1485        | 0:00:16       | 0:30:00    |
## Round 1
- Epochs: **5**
- LR Scheduler: **OneCycleLR**
### Optimizer
| Property                  | Value                     |
| ------------------------- | ------------------------- |
| name                      | AdamW                     |
| lr                        | 0.001                     |
| betas                     | (0.9, 0.999)              |
| eps                       | 1e-08                     |
| weight_decay              | 0.01                      |
| amsgrad                   | False                     |
### LRs
| Network Part              | LRs                  | Frozen? |
| ------------------------- | -------------------- | ------- |
| net.model.feature_extractor | 1.04e-04, 1.04e-04   | False   |
| net.model.conv_transpose_shared | 2.08e-04, 2.08e-04   | False   |
| net.model.head_pose_2d    | 2.08e-04, 2.08e-04   | False   |
| net.model.head_pose_3d    | 2.08e-04, 2.08e-04   | False   |
| net.model.head_orientation | 2.08e-04, 2.08e-04   | False   |
| net.model.head_conf       | 2.08e-04, 2.08e-04   | False   |
### Results
| Epoch | Train Loss | COCO PCK@0.05 | COCO PCK@0.2 | COCO JointAcc | COCO Body Sph.Dist. | COCO Body.Phi.Ang.Dist. | COCO Head Sph.Dist. | COCO Head.Phi.Ang.Dist. | COCO Val Loss | COCO Val Time | SIM PCK@0.05 | SIM PCK@0.2 | SIM MPJPE | SIM MRCJP | SIM MRCD | SIM JointAcc | SIM Body Sph.Dist. | SIM Body.Phi.Ang.Dist. | SIM Head Sph.Dist. | SIM Head.Phi.Ang.Dist. | SIM Val Loss | SIM Val Time | H36M PCK@0.05 | H36M PCK@0.2 | H36M MPJPE | H36M MRCJP | H36M MRCD | H36M JointAcc | H36M Val Loss | H36M Val Time | Train Time |
| ----- | ---------- | ------------- | ------------ | ------------- | ------------------- | ----------------------- | ------------------- | ----------------------- | ------------- | ------------- | ------------ | ----------- | --------- | --------- | -------- | ------------ | ------------------ | ---------------------- | ------------------ | ---------------------- | ------------ | ------------ | ------------- | ------------ | ---------- | ---------- | --------- | ------------- | ------------- | ------------- | ---------- |
| 0     | 0.12812    | 53.41         | 91.62        | 0.88          | 0.00                | 0.18                    | 0.00                | 0.00                    | 0.5839        | 0:00:11       | 96.60        | 99.99       | 16.42     | 0.86      | 0.95     | 1.00         | 0.05               | 0.05                   | 0.07               | 0.07                   | 0.0742       | 0:00:10      | 60.80         | 92.56        | 64.84      | 0.79       | 0.92      | 1.00          | 0.1497        | 0:00:16       | 0:34:47    |
| 1     | 0.12920    | 53.54         | 91.67        | 0.88          | 0.00                | 0.18                    | 0.00                | 0.00                    | 0.5840        | 0:00:11       | 96.70        | 99.99       | 16.35     | 0.86      | 0.95     | 1.00         | 0.05               | 0.05                   | 0.07               | 0.07                   | 0.0742       | 0:00:10      | 61.02         | 92.58        | 65.05      | 0.79       | 0.92      | 1.00          | 0.1490        | 0:00:16       | 0:34:46    |
| 2     | 0.12700    | 53.64         | 91.77        | 0.88          | 0.00                | 0.18                    | 0.00                | 0.00                    | 0.5786        | 0:00:11       | 96.86        | 99.99       | 15.76     | 0.86      | 0.95     | 1.00         | 0.05               | 0.05                   | 0.06               | 0.06                   | 0.0719       | 0:00:10      | 61.00         | 92.59        | 64.89      | 0.80       | 0.92      | 1.00          | 0.1492        | 0:00:16       | 0:34:46    |
| 3     | 0.12484    | 53.66         | 91.83        | 0.89          | 0.00                | 0.18                    | 0.00                | 0.00                    | 0.5743        | 0:00:11       | 97.06        | 99.99       | 15.28     | 0.86      | 0.96     | 1.00         | 0.04               | 0.04                   | 0.06               | 0.06                   | 0.0701       | 0:00:10      | 61.11         | 92.62        | 64.66      | 0.80       | 0.92      | 1.00          | 0.1490        | 0:00:16       | 0:34:46    |
| 4     | 0.12351    | 53.72         | 91.88        | 0.89          | 0.00                | 0.18                    | 0.00                | 0.00                    | 0.5733        | 0:00:11       | 97.12        | 99.99       | 15.13     | 0.86      | 0.96     | 1.00         | 0.04               | 0.04                   | 0.06               | 0.06                   | 0.0695       | 0:00:10      | 61.23         | 92.66        | 64.37      | 0.80       | 0.92      | 1.00          | 0.1486        | 0:00:16       | 0:34:46    |
