# PedRecNet2D
## Trial Name
**experiment_pedrec_p2d3d_c_o_sim**
## Initialization
| Network Part                   | Initialization                                               |
| ------------------------------ | ------------------------------------------------------------ |
| net.model.feature_extractor    | TODO                                                         |
| net.model.conv_transpose_shared | TODO                                                         |
| net.model.head_pose_2d         | TODO                                                         |
| net.model.head_pose_3d         | TODO                                                         |
| net.model.head_orientation     | TODO                                                         |
| net.model.head_conf            | TODO                                                         |
Notes. Initialized from p2d3d_c_sim
## Datasets
### Training
| Dataset                   | Subsampling | Full set length | Used length |
| ------------------------- | ----------- | --------------- | ----------- |
| COCO (TRAIN)              | 1           | 149813          | 149813      |
| rt_rom_01b.pkl            | 1           | 147729          | 147729      |
| rt_validate_3d.pkl        | 1           | 39484           | 39484       |
### Validation
| Dataset                   | Subsampling | Full set length | Used length |
| ------------------------- | ----------- | --------------- | ----------- |
| COCO (VAL)                | 1           | 6352            | 6352        |
| rt_validate_3d.pkl        | 10          | 3949            | 3949        |
| h36m_val_pedrec.pkl       | 64          | 8604            | 8604        |
## Augmentation
### Training Augmentations - COCO
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 30                        |
### Training Augmentations - SIM
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 0                         |
### Training Augmentations - H36M
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 0                         |
## General data preparation
```python
trans = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
])
```
suggested lr: 2.08e-03
## Round 0
- Epochs: **10**
- LR Scheduler: **OneCycleLR**
### Optimizer
| Property                  | Value                     |
| ------------------------- | ------------------------- |
| name                      | AdamW                     |
| lr                        | 0.001                     |
| betas                     | (0.9, 0.999)              |
| eps                       | 1e-08                     |
| weight_decay              | 0.01                      |
| amsgrad                   | False                     |
### LRs
| Network Part              | LRs                  | Frozen? |
| ------------------------- | -------------------- | ------- |
| net.model.feature_extractor | 2.08e-03, 2.08e-03   | True    |
| net.model.conv_transpose_shared | 2.08e-03, 2.08e-03   | False   |
| net.model.head_pose_2d    | 2.08e-03, 2.08e-03   | False   |
| net.model.head_pose_3d    | 2.08e-03, 2.08e-03   | False   |
| net.model.head_orientation | 2.08e-03, 2.08e-03   | False   |
| net.model.head_conf       | 2.08e-03, 2.08e-03   | False   |
### Results
| Epoch | Train Loss | COCO PCK@0.05 | COCO PCK@0.2 | COCO JointAcc | COCO Body Sph.Dist. | COCO Body.Phi.Ang.Dist. | COCO Head Sph.Dist. | COCO Head.Phi.Ang.Dist. | COCO Val Loss | COCO Val Time | SIM PCK@0.05 | SIM PCK@0.2 | SIM MPJPE | SIM MRCJP | SIM MRCD | SIM JointAcc | SIM Body Sph.Dist. | SIM Body.Phi.Ang.Dist. | SIM Head Sph.Dist. | SIM Head.Phi.Ang.Dist. | SIM Val Loss | SIM Val Time | H36M PCK@0.05 | H36M PCK@0.2 | H36M MPJPE | H36M MRCJP | H36M MRCD | H36M JointAcc | H36M Val Loss | H36M Val Time | Train Time |
| ----- | ---------- | ------------- | ------------ | ------------- | ------------------- | ----------------------- | ------------------- | ----------------------- | ------------- | ------------- | ------------ | ----------- | --------- | --------- | -------- | ------------ | ------------------ | ---------------------- | ------------------ | ---------------------- | ------------ | ------------ | ------------- | ------------ | ---------- | ---------- | --------- | ------------- | ------------- | ------------- | ---------- |
| 0     | 0.27044    | 54.19         | 92.04        | 0.88          | 0.00                | 0.29                    | 0.00                | 0.00                    | 0.7006        | 0:00:22       | 95.84        | 99.99       | 19.02     | 0.84      | 0.94     | 1.00         | 0.10               | 0.10                   | 0.16               | 0.14                   | 0.1092       | 0:00:19      | 23.84         | 85.76        | 179.06     | 0.55       | 0.77      | 0.97          | 0.3633        | 0:00:29       | 0:38:54    |
| 1     | 0.15453    | 54.02         | 91.97        | 0.87          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.7132        | 0:00:21       | 95.17        | 99.99       | 21.72     | 0.83      | 0.94     | 1.00         | 0.12               | 0.12                   | 0.14               | 0.13                   | 0.1083       | 0:00:19      | 24.32         | 85.93        | 178.13     | 0.55       | 0.77      | 0.99          | 0.3572        | 0:00:29       | 0:38:53    |
| 2     | 0.16722    | 53.98         | 91.95        | 0.84          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.7519        | 0:00:21       | 94.96        | 99.99       | 22.16     | 0.83      | 0.94     | 1.00         | 0.14               | 0.14                   | 0.15               | 0.13                   | 0.1195       | 0:00:18      | 23.78         | 85.60        | 176.08     | 0.56       | 0.78      | 1.00          | 0.3693        | 0:00:28       | 0:38:51    |
| 3     | 0.16236    | 53.87         | 92.04        | 0.86          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.7236        | 0:00:21       | 95.05        | 99.99       | 21.69     | 0.84      | 0.94     | 1.00         | 0.11               | 0.11                   | 0.11               | 0.10                   | 0.1054       | 0:00:18      | 24.35         | 85.61        | 180.26     | 0.54       | 0.76      | 0.98          | 0.3744        | 0:00:28       | 0:38:49    |
| 4     | 0.15700    | 54.08         | 92.08        | 0.86          | 0.00                | 0.31                    | 0.00                | 0.00                    | 0.7384        | 0:00:21       | 95.58        | 99.99       | 20.09     | 0.84      | 0.94     | 1.00         | 0.12               | 0.12                   | 0.11               | 0.11                   | 0.1056       | 0:00:18      | 23.86         | 85.57        | 179.16     | 0.54       | 0.77      | 0.99          | 0.3838        | 0:00:28       | 0:38:50    |
| 5     | 0.15037    | 54.23         | 92.00        | 0.87          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.7140        | 0:00:21       | 96.11        | 100.00      | 18.86     | 0.85      | 0.95     | 1.00         | 0.10               | 0.11                   | 0.09               | 0.08                   | 0.0973       | 0:00:18      | 24.56         | 85.82        | 179.13     | 0.55       | 0.77      | 0.98          | 0.3788        | 0:00:28       | 0:38:58    |
| 6     | 0.14400    | 54.36         | 92.04        | 0.87          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.7102        | 0:00:21       | 96.45        | 99.99       | 17.21     | 0.86      | 0.95     | 1.00         | 0.09               | 0.09                   | 0.08               | 0.07                   | 0.0924       | 0:00:18      | 24.33         | 85.78        | 179.87     | 0.54       | 0.76      | 0.99          | 0.3813        | 0:00:28       | 0:38:49    |
| 7     | 0.13804    | 54.39         | 92.06        | 0.88          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.7057        | 0:00:21       | 96.70        | 99.99       | 16.19     | 0.87      | 0.96     | 1.00         | 0.09               | 0.09                   | 0.07               | 0.06                   | 0.0869       | 0:00:18      | 24.47         | 85.83        | 180.18     | 0.54       | 0.77      | 0.99          | 0.3871        | 0:00:28       | 0:38:49    |
| 8     | 0.13357    | 54.48         | 92.07        | 0.88          | 0.00                | 0.29                    | 0.00                | 0.00                    | 0.7089        | 0:00:21       | 96.87        | 99.99       | 15.59     | 0.87      | 0.96     | 1.00         | 0.08               | 0.08                   | 0.07               | 0.06                   | 0.0861       | 0:00:18      | 24.57         | 85.91        | 180.41     | 0.54       | 0.77      | 0.99          | 0.3867        | 0:00:28       | 0:38:59    |
| 9     | 0.13112    | 54.33         | 92.03        | 0.88          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.7043        | 0:00:21       | 96.87        | 99.99       | 15.45     | 0.87      | 0.96     | 1.00         | 0.08               | 0.08                   | 0.06               | 0.06                   | 0.0849       | 0:00:18      | 24.37         | 85.77        | 180.86     | 0.54       | 0.77      | 0.99          | 0.3897        | 0:00:28       | 0:39:08    |
## Round 1
- Epochs: **5**
- LR Scheduler: **OneCycleLR**
### Optimizer
| Property                  | Value                     |
| ------------------------- | ------------------------- |
| name                      | AdamW                     |
| lr                        | 0.001                     |
| betas                     | (0.9, 0.999)              |
| eps                       | 1e-08                     |
| weight_decay              | 0.01                      |
| amsgrad                   | False                     |
### LRs
| Network Part              | LRs                  | Frozen? |
| ------------------------- | -------------------- | ------- |
| net.model.feature_extractor | 1.04e-04, 1.04e-04   | False   |
| net.model.conv_transpose_shared | 2.08e-04, 2.08e-04   | False   |
| net.model.head_pose_2d    | 2.08e-04, 2.08e-04   | False   |
| net.model.head_pose_3d    | 2.08e-04, 2.08e-04   | False   |
| net.model.head_orientation | 2.08e-04, 2.08e-04   | False   |
| net.model.head_conf       | 2.08e-04, 2.08e-04   | False   |
### Results
| Epoch | Train Loss | COCO PCK@0.05 | COCO PCK@0.2 | COCO JointAcc | COCO Body Sph.Dist. | COCO Body.Phi.Ang.Dist. | COCO Head Sph.Dist. | COCO Head.Phi.Ang.Dist. | COCO Val Loss | COCO Val Time | SIM PCK@0.05 | SIM PCK@0.2 | SIM MPJPE | SIM MRCJP | SIM MRCD | SIM JointAcc | SIM Body Sph.Dist. | SIM Body.Phi.Ang.Dist. | SIM Head Sph.Dist. | SIM Head.Phi.Ang.Dist. | SIM Val Loss | SIM Val Time | H36M PCK@0.05 | H36M PCK@0.2 | H36M MPJPE | H36M MRCJP | H36M MRCD | H36M JointAcc | H36M Val Loss | H36M Val Time | Train Time |
| ----- | ---------- | ------------- | ------------ | ------------- | ------------------- | ----------------------- | ------------------- | ----------------------- | ------------- | ------------- | ------------ | ----------- | --------- | --------- | -------- | ------------ | ------------------ | ---------------------- | ------------------ | ---------------------- | ------------ | ------------ | ------------- | ------------ | ---------- | ---------- | --------- | ------------- | ------------- | ------------- | ---------- |
| 0     | 0.13134    | 54.11         | 91.94        | 0.88          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.7084        | 0:00:21       | 96.73        | 99.99       | 15.80     | 0.87      | 0.96     | 1.00         | 0.08               | 0.08                   | 0.06               | 0.05                   | 0.0854       | 0:00:18      | 24.03         | 85.78        | 182.42     | 0.54       | 0.76      | 0.99          | 0.3888        | 0:00:28       | 0:46:14    |
| 1     | 0.13273    | 53.91         | 91.95        | 0.88          | 0.00                | 0.29                    | 0.00                | 0.00                    | 0.7117        | 0:00:21       | 96.79        | 99.97       | 15.78     | 0.87      | 0.96     | 1.00         | 0.09               | 0.09                   | 0.06               | 0.06                   | 0.0864       | 0:00:18      | 23.82         | 85.58        | 182.50     | 0.54       | 0.76      | 0.99          | 0.3868        | 0:00:28       | 0:46:17    |
| 2     | 0.13036    | 54.06         | 91.93        | 0.88          | 0.00                | 0.29                    | 0.00                | 0.00                    | 0.7098        | 0:00:21       | 97.07        | 99.99       | 14.90     | 0.87      | 0.96     | 1.00         | 0.08               | 0.08                   | 0.06               | 0.05                   | 0.0821       | 0:00:18      | 24.25         | 85.78        | 181.49     | 0.54       | 0.76      | 0.99          | 0.3895        | 0:00:28       | 0:46:16    |
| 3     | 0.12739    | 54.11         | 91.94        | 0.88          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.7104        | 0:00:21       | 97.19        | 99.99       | 14.33     | 0.88      | 0.96     | 1.00         | 0.07               | 0.08                   | 0.05               | 0.05                   | 0.0803       | 0:00:18      | 24.22         | 85.85        | 181.81     | 0.54       | 0.76      | 0.99          | 0.3964        | 0:00:28       | 0:46:16    |
| 4     | 0.12530    | 54.05         | 91.95        | 0.88          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.7089        | 0:00:21       | 97.30        | 99.99       | 14.14     | 0.88      | 0.96     | 1.00         | 0.07               | 0.07                   | 0.05               | 0.05                   | 0.0792       | 0:00:18      | 24.03         | 85.84        | 181.49     | 0.54       | 0.76      | 0.99          | 0.3980        | 0:00:28       | 0:46:17    |
