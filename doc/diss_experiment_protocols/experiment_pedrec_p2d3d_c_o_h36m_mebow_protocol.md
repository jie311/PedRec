# PedRecNet2D
## Trial Name
**experiment_pedrec_p2d3d_c_o_h36m_mebow**
## Initialization
| Network Part                   | Initialization                                               |
| ------------------------------ | ------------------------------------------------------------ |
| net.model.feature_extractor    | TODO                                                         |
| net.model.conv_transpose_shared | TODO                                                         |
| net.model.head_pose_2d         | TODO                                                         |
| net.model.head_pose_3d         | TODO                                                         |
| net.model.head_orientation     | TODO                                                         |
| net.model.head_conf            | TODO                                                         |
Notes. Initialized from p2d3d_h36m_conf
## Datasets
### Training
| Dataset                   | Subsampling | Full set length | Used length |
| ------------------------- | ----------- | --------------- | ----------- |
| COCO (TRAIN)              | 1           | 149813          | 149813      |
| h36m_train_pedrec.pkl     | 10          | 155976          | 155976      |
### Validation
| Dataset                   | Subsampling | Full set length | Used length |
| ------------------------- | ----------- | --------------- | ----------- |
| COCO (VAL)                | 1           | 6352            | 6352        |
| rt_validate_3d.pkl        | 10          | 3949            | 3949        |
| h36m_val_pedrec.pkl       | 64          | 8604            | 8604        |
## Augmentation
### Training Augmentations - COCO
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 0                         |
### Training Augmentations - SIM
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 0                         |
### Training Augmentations - H36M
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 0                         |
## General data preparation
```python
trans = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
])
```
suggested lr: 2.08e-03
## Round 0
- Epochs: **10**
- LR Scheduler: **OneCycleLR**
### Optimizer
| Property                  | Value                     |
| ------------------------- | ------------------------- |
| name                      | AdamW                     |
| lr                        | 0.001                     |
| betas                     | (0.9, 0.999)              |
| eps                       | 1e-08                     |
| weight_decay              | 0.01                      |
| amsgrad                   | False                     |
### LRs
| Network Part              | LRs                  | Frozen? |
| ------------------------- | -------------------- | ------- |
| net.model.feature_extractor | 2.08e-03, 2.08e-03   | True    |
| net.model.conv_transpose_shared | 2.08e-03, 2.08e-03   | False   |
| net.model.head_pose_2d    | 2.08e-03, 2.08e-03   | False   |
| net.model.head_pose_3d    | 2.08e-03, 2.08e-03   | False   |
| net.model.head_orientation | 2.08e-03, 2.08e-03   | False   |
| net.model.head_conf       | 2.08e-03, 2.08e-03   | False   |
### Results
| Epoch | Train Loss | COCO PCK@0.05 | COCO PCK@0.2 | COCO JointAcc | COCO Body Sph.Dist. | COCO Body.Phi.Ang.Dist. | COCO Head Sph.Dist. | COCO Head.Phi.Ang.Dist. | COCO Val Loss | COCO Val Time | SIM PCK@0.05 | SIM PCK@0.2 | SIM MPJPE | SIM MRCJP | SIM MRCD | SIM JointAcc | SIM Body Sph.Dist. | SIM Body.Phi.Ang.Dist. | SIM Head Sph.Dist. | SIM Head.Phi.Ang.Dist. | SIM Val Loss | SIM Val Time | H36M PCK@0.05 | H36M PCK@0.2 | H36M MPJPE | H36M MRCJP | H36M MRCD | H36M JointAcc | H36M Val Loss | H36M Val Time | Train Time |
| ----- | ---------- | ------------- | ------------ | ------------- | ------------------- | ----------------------- | ------------------- | ----------------------- | ------------- | ------------- | ------------ | ----------- | --------- | --------- | -------- | ------------ | ------------------ | ---------------------- | ------------------ | ---------------------- | ------------ | ------------ | ------------- | ------------ | ---------- | ---------- | --------- | ------------- | ------------- | ------------- | ---------- |
| 0     | 0.54796    | 54.79         | 92.18        | 0.90          | 0.00                | 0.21                    | 0.00                | 0.00                    | 0.6249        | 0:00:22       | 34.63        | 95.41       | 332.04    | 0.51      | 0.73     | 0.92         | 0.26               | 0.25                   | 1.26               | 1.54                   | 0.7749       | 0:00:18      | 59.87         | 92.55        | 64.72      | 0.79       | 0.92      | 1.00          | 0.1471        | 0:00:29       | 0:35:06    |
| 1     | 0.22892    | 54.49         | 92.08        | 0.89          | 0.00                | 0.35                    | 0.00                | 0.00                    | 0.8117        | 0:00:21       | 34.45        | 95.38       | 342.22    | 0.51      | 0.73     | 0.91         | 0.47               | 0.50                   | 1.29               | 1.58                   | 0.7699       | 0:00:18      | 59.27         | 92.43        | 67.38      | 0.78       | 0.92      | 1.00          | 0.1622        | 0:00:29       | 0:35:05    |
| 2     | 0.23341    | 54.38         | 92.04        | 0.88          | 0.00                | 0.21                    | 0.00                | 0.00                    | 0.7640        | 0:00:22       | 34.67        | 95.31       | 325.45    | 0.51      | 0.74     | 0.92         | 0.30               | 0.30                   | 1.28               | 1.57                   | 0.7195       | 0:00:18      | 58.99         | 92.51        | 65.10      | 0.78       | 0.92      | 1.00          | 0.1602        | 0:00:29       | 0:35:04    |
| 3     | 0.23184    | 54.37         | 92.08        | 0.87          | 0.00                | 0.19                    | 0.00                | 0.00                    | 0.7663        | 0:00:21       | 34.65        | 95.17       | 342.43    | 0.51      | 0.73     | 0.91         | 0.25               | 0.24                   | 1.28               | 1.57                   | 0.7239       | 0:00:18      | 58.82         | 92.49        | 66.67      | 0.79       | 0.92      | 1.00          | 0.1584        | 0:00:29       | 0:35:05    |
| 4     | 0.22480    | 54.56         | 92.07        | 0.88          | 0.00                | 0.20                    | 0.00                | 0.00                    | 0.7613        | 0:00:21       | 34.79        | 95.33       | 332.39    | 0.51      | 0.73     | 0.91         | 0.26               | 0.25                   | 1.28               | 1.57                   | 0.7302       | 0:00:17      | 59.69         | 92.65        | 67.32      | 0.79       | 0.92      | 1.00          | 0.1584        | 0:00:28       | 0:35:05    |
| 5     | 0.21922    | 54.56         | 92.12        | 0.88          | 0.00                | 0.18                    | 0.00                | 0.00                    | 0.7530        | 0:00:21       | 34.74        | 95.48       | 324.37    | 0.51      | 0.73     | 0.92         | 0.26               | 0.25                   | 1.28               | 1.57                   | 0.7440       | 0:00:18      | 59.99         | 92.51        | 65.49      | 0.79       | 0.92      | 1.00          | 0.1588        | 0:00:29       | 0:35:05    |
| 6     | 0.21300    | 54.88         | 92.22        | 0.89          | 0.00                | 0.19                    | 0.00                | 0.00                    | 0.7549        | 0:00:22       | 35.06        | 95.51       | 329.37    | 0.51      | 0.73     | 0.91         | 0.26               | 0.25                   | 1.28               | 1.57                   | 0.7504       | 0:00:17      | 60.19         | 92.58        | 65.29      | 0.79       | 0.92      | 1.00          | 0.1587        | 0:00:29       | 0:35:07    |
| 7     | 0.21054    | 54.91         | 92.15        | 0.89          | 0.00                | 0.18                    | 0.00                | 0.00                    | 0.7381        | 0:00:22       | 34.71        | 95.41       | 331.94    | 0.51      | 0.73     | 0.91         | 0.25               | 0.25                   | 1.28               | 1.56                   | 0.7726       | 0:00:18      | 59.98         | 92.62        | 64.31      | 0.79       | 0.92      | 1.00          | 0.1581        | 0:00:29       | 0:35:06    |
| 8     | 0.20447    | 55.02         | 92.18        | 0.89          | 0.00                | 0.19                    | 0.00                | 0.00                    | 0.7449        | 0:00:21       | 35.03        | 95.48       | 322.78    | 0.51      | 0.73     | 0.91         | 0.25               | 0.24                   | 1.28               | 1.56                   | 0.7584       | 0:00:18      | 60.21         | 92.58        | 63.68      | 0.79       | 0.92      | 1.00          | 0.1585        | 0:00:28       | 0:35:07    |
| 9     | 0.20222    | 55.02         | 92.16        | 0.90          | 0.00                | 0.18                    | 0.00                | 0.00                    | 0.7468        | 0:00:22       | 35.03        | 95.52       | 325.78    | 0.51      | 0.73     | 0.91         | 0.25               | 0.24                   | 1.28               | 1.56                   | 0.7626       | 0:00:18      | 60.19         | 92.59        | 63.70      | 0.79       | 0.92      | 1.00          | 0.1585        | 0:00:29       | 0:35:07    |
## Round 1
- Epochs: **5**
- LR Scheduler: **OneCycleLR**
### Optimizer
| Property                  | Value                     |
| ------------------------- | ------------------------- |
| name                      | AdamW                     |
| lr                        | 0.001                     |
| betas                     | (0.9, 0.999)              |
| eps                       | 1e-08                     |
| weight_decay              | 0.01                      |
| amsgrad                   | False                     |
### LRs
| Network Part              | LRs                  | Frozen? |
| ------------------------- | -------------------- | ------- |
| net.model.feature_extractor | 1.04e-04, 1.04e-04   | False   |
| net.model.conv_transpose_shared | 2.08e-04, 2.08e-04   | False   |
| net.model.head_pose_2d    | 2.08e-04, 2.08e-04   | False   |
| net.model.head_pose_3d    | 2.08e-04, 2.08e-04   | False   |
| net.model.head_orientation | 2.08e-04, 2.08e-04   | False   |
| net.model.head_conf       | 2.08e-04, 2.08e-04   | False   |
### Results
| Epoch | Train Loss | COCO PCK@0.05 | COCO PCK@0.2 | COCO JointAcc | COCO Body Sph.Dist. | COCO Body.Phi.Ang.Dist. | COCO Head Sph.Dist. | COCO Head.Phi.Ang.Dist. | COCO Val Loss | COCO Val Time | SIM PCK@0.05 | SIM PCK@0.2 | SIM MPJPE | SIM MRCJP | SIM MRCD | SIM JointAcc | SIM Body Sph.Dist. | SIM Body.Phi.Ang.Dist. | SIM Head Sph.Dist. | SIM Head.Phi.Ang.Dist. | SIM Val Loss | SIM Val Time | H36M PCK@0.05 | H36M PCK@0.2 | H36M MPJPE | H36M MRCJP | H36M MRCD | H36M JointAcc | H36M Val Loss | H36M Val Time | Train Time |
| ----- | ---------- | ------------- | ------------ | ------------- | ------------------- | ----------------------- | ------------------- | ----------------------- | ------------- | ------------- | ------------ | ----------- | --------- | --------- | -------- | ------------ | ------------------ | ---------------------- | ------------------ | ---------------------- | ------------ | ------------ | ------------- | ------------ | ---------- | ---------- | --------- | ------------- | ------------- | ------------- | ---------- |
| 0     | 0.20203    | 54.75         | 91.96        | 0.89          | 0.00                | 0.18                    | 0.00                | 0.00                    | 0.7478        | 0:00:22       | 35.27        | 95.62       | 336.21    | 0.51      | 0.73     | 0.91         | 0.25               | 0.25                   | 1.28               | 1.56                   | 0.7706       | 0:00:17      | 60.43         | 92.53        | 64.33      | 0.79       | 0.92      | 1.00          | 0.1583        | 0:00:28       | 0:41:46    |
| 1     | 0.20304    | 54.81         | 92.03        | 0.89          | 0.00                | 0.18                    | 0.00                | 0.00                    | 0.7337        | 0:00:21       | 34.73        | 95.43       | 289.62    | 0.51      | 0.73     | 0.91         | 0.25               | 0.25                   | 1.27               | 1.56                   | 0.6962       | 0:00:18      | 60.13         | 92.48        | 64.14      | 0.79       | 0.92      | 1.00          | 0.1576        | 0:00:29       | 0:41:44    |
| 2     | 0.20046    | 54.78         | 92.08        | 0.89          | 0.00                | 0.17                    | 0.00                | 0.00                    | 0.7360        | 0:00:21       | 34.85        | 95.51       | 291.85    | 0.51      | 0.73     | 0.91         | 0.24               | 0.24                   | 1.28               | 1.56                   | 0.7023       | 0:00:17      | 60.48         | 92.54        | 64.34      | 0.79       | 0.92      | 1.00          | 0.1577        | 0:00:29       | 0:41:45    |
| 3     | 0.19636    | 54.95         | 92.11        | 0.90          | 0.00                | 0.17                    | 0.00                | 0.00                    | 0.7249        | 0:00:22       | 34.75        | 95.51       | 292.30    | 0.51      | 0.73     | 0.91         | 0.24               | 0.24                   | 1.28               | 1.56                   | 0.7084       | 0:00:18      | 60.58         | 92.61        | 63.56      | 0.79       | 0.92      | 1.00          | 0.1571        | 0:00:29       | 0:41:46    |
| 4     | 0.19373    | 54.96         | 92.08        | 0.90          | 0.00                | 0.17                    | 0.00                | 0.00                    | 0.7255        | 0:00:21       | 34.98        | 95.53       | 294.80    | 0.51      | 0.73     | 0.91         | 0.24               | 0.24                   | 1.28               | 1.56                   | 0.7152       | 0:00:18      | 60.47         | 92.59        | 63.83      | 0.79       | 0.92      | 1.00          | 0.1579        | 0:00:29       | 0:41:45    |
