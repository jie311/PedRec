# PedRecNet2D
## Trial Name
**experiment_pedrec_p2d3d_h36m**
## Initialization
| Network Part                   | Initialization                                               |
| ------------------------------ | ------------------------------------------------------------ |
| net.model.feature_extractor    | TODO                                                         |
| net.model.conv_transpose_shared | TODO                                                         |
| net.model.head_pose_2d         | TODO                                                         |
| net.model.head_pose_3d         | TODO                                                         |
| net.model.head_orientation     | TODO                                                         |
| net.model.head_conf            | TODO                                                         |
Notes. Initialized from p2d_h36m
## Datasets
### Training
| Dataset                   | Subsampling | Full set length | Used length |
| ------------------------- | ----------- | --------------- | ----------- |
| COCO (TRAIN)              | 1           | 149813          | 149813      |
| h36m_train_pedrec.pkl     | 10          | 155976          | 155976      |
### Validation
| Dataset                   | Subsampling | Full set length | Used length |
| ------------------------- | ----------- | --------------- | ----------- |
| COCO (VAL)                | 1           | 6352            | 6352        |
| rt_validate_3d.pkl        | 10          | 3949            | 3949        |
| h36m_val_pedrec.pkl       | 64          | 8604            | 8604        |
## Augmentation
### Training Augmentations - COCO
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 30                        |
### Training Augmentations - SIM
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 0                         |
### Training Augmentations - H36M
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 0                         |
## General data preparation
```python
trans = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
])
```
suggested lr: 2.08e-03
## Round 0
- Epochs: **10**
- LR Scheduler: **OneCycleLR**
### Optimizer
| Property                  | Value                     |
| ------------------------- | ------------------------- |
| name                      | AdamW                     |
| lr                        | 0.001                     |
| betas                     | (0.9, 0.999)              |
| eps                       | 1e-08                     |
| weight_decay              | 0.01                      |
| amsgrad                   | False                     |
### LRs
| Network Part              | LRs                  | Frozen? |
| ------------------------- | -------------------- | ------- |
| net.model.feature_extractor | 2.08e-03, 2.08e-03   | True    |
| net.model.conv_transpose_shared | 2.08e-03, 2.08e-03   | False   |
| net.model.head_pose_2d    | 2.08e-03, 2.08e-03   | False   |
| net.model.head_pose_3d    | 2.08e-03, 2.08e-03   | False   |
| net.model.head_orientation | 0.00e+00, 0.00e+00   | False   |
| net.model.head_conf       | 0.00e+00, 0.00e+00   | False   |
### Results
| Epoch | Train Loss | COCO PCK@0.05 | COCO PCK@0.2 | COCO Val Loss | COCO Val Time | SIM PCK@0.05 | SIM PCK@0.2 | SIM MPJPE | SIM MRCJP | SIM MRCD | SIM Val Loss | SIM Val Time | H36M PCK@0.05 | H36M PCK@0.2 | H36M MPJPE | H36M MRCJP | H36M MRCD | H36M Val Loss | H36M Val Time | Train Time |
| ----- | ---------- | ------------- | ------------ | ------------- | ------------- | ------------ | ----------- | --------- | --------- | -------- | ------------ | ------------ | ------------- | ------------ | ---------- | ---------- | --------- | ------------- | ------------- | ---------- |
| 0     | 0.28014    | 55.00         | 92.39        | 0.2149        | 0:00:12       | 33.37        | 95.71       | 363.29    | 0.48      | 0.71     | 0.2278       | 0:00:11      | 58.40         | 92.38        | 87.29      | 0.72       | 0.89      | 0.1050        | 0:00:17       | 0:18:37    |
| 1     | 0.09342    | 54.69         | 92.37        | 0.2196        | 0:00:12       | 33.35        | 95.38       | 356.18    | 0.49      | 0.72     | 0.2392       | 0:00:11      | 57.59         | 92.22        | 78.81      | 0.75       | 0.90      | 0.1021        | 0:00:16       | 0:18:44    |
| 2     | 0.09014    | 54.56         | 92.18        | 0.2220        | 0:00:12       | 33.14        | 95.35       | 361.78    | 0.49      | 0.73     | 0.2515       | 0:00:10      | 56.33         | 92.18        | 75.63      | 0.75       | 0.90      | 0.1015        | 0:00:16       | 0:18:31    |
| 3     | 0.08728    | 54.61         | 92.21        | 0.2246        | 0:00:12       | 32.77        | 95.23       | 361.04    | 0.50      | 0.73     | 0.2611       | 0:00:10      | 57.29         | 92.23        | 74.25      | 0.76       | 0.91      | 0.1007        | 0:00:16       | 0:18:44    |
| 4     | 0.08478    | 54.52         | 92.23        | 0.2294        | 0:00:12       | 33.41        | 95.32       | 356.38    | 0.50      | 0.73     | 0.2655       | 0:00:10      | 57.82         | 92.21        | 72.81      | 0.77       | 0.91      | 0.1001        | 0:00:16       | 0:18:24    |
| 5     | 0.08254    | 54.75         | 92.32        | 0.2270        | 0:00:12       | 33.38        | 95.27       | 364.06    | 0.50      | 0.73     | 0.2804       | 0:00:10      | 57.72         | 92.29        | 69.56      | 0.77       | 0.91      | 0.0989        | 0:00:16       | 0:18:15    |
| 6     | 0.08048    | 54.80         | 92.34        | 0.2292        | 0:00:11       | 33.25        | 95.22       | 353.27    | 0.51      | 0.73     | 0.2770       | 0:00:10      | 57.83         | 92.27        | 68.68      | 0.78       | 0.91      | 0.0986        | 0:00:16       | 0:17:50    |
| 7     | 0.07872    | 54.99         | 92.39        | 0.2326        | 0:00:11       | 34.15        | 95.44       | 347.32    | 0.51      | 0.73     | 0.2800       | 0:00:10      | 58.24         | 92.32        | 68.78      | 0.77       | 0.91      | 0.0990        | 0:00:16       | 0:17:46    |
| 8     | 0.07742    | 55.12         | 92.37        | 0.2317        | 0:00:12       | 34.07        | 95.36       | 357.41    | 0.51      | 0.73     | 0.2883       | 0:00:10      | 58.68         | 92.37        | 67.77      | 0.78       | 0.92      | 0.0982        | 0:00:16       | 0:18:37    |
| 9     | 0.07677    | 55.12         | 92.45        | 0.2330        | 0:00:12       | 33.98        | 95.33       | 348.59    | 0.51      | 0.73     | 0.2834       | 0:00:10      | 58.50         | 92.36        | 67.72      | 0.78       | 0.92      | 0.0984        | 0:00:16       | 0:18:09    |
## Round 1
- Epochs: **5**
- LR Scheduler: **OneCycleLR**
### Optimizer
| Property                  | Value                     |
| ------------------------- | ------------------------- |
| name                      | AdamW                     |
| lr                        | 0.001                     |
| betas                     | (0.9, 0.999)              |
| eps                       | 1e-08                     |
| weight_decay              | 0.01                      |
| amsgrad                   | False                     |
### LRs
| Network Part              | LRs                  | Frozen? |
| ------------------------- | -------------------- | ------- |
| net.model.feature_extractor | 1.04e-04, 1.04e-04   | False   |
| net.model.conv_transpose_shared | 2.08e-04, 2.08e-04   | False   |
| net.model.head_pose_2d    | 2.08e-04, 2.08e-04   | False   |
| net.model.head_pose_3d    | 2.08e-04, 2.08e-04   | False   |
| net.model.head_orientation | 0.00e+00, 0.00e+00   | False   |
| net.model.head_conf       | 0.00e+00, 0.00e+00   | False   |
### Results
| Epoch | Train Loss | COCO PCK@0.05 | COCO PCK@0.2 | COCO Val Loss | COCO Val Time | SIM PCK@0.05 | SIM PCK@0.2 | SIM MPJPE | SIM MRCJP | SIM MRCD | SIM Val Loss | SIM Val Time | H36M PCK@0.05 | H36M PCK@0.2 | H36M MPJPE | H36M MRCJP | H36M MRCD | H36M Val Loss | H36M Val Time | Train Time |
| ----- | ---------- | ------------- | ------------ | ------------- | ------------- | ------------ | ----------- | --------- | --------- | -------- | ------------ | ------------ | ------------- | ------------ | ---------- | ---------- | --------- | ------------- | ------------- | ---------- |
| 0     | 0.07621    | 54.81         | 92.22        | 0.2315        | 0:00:11       | 33.98        | 95.27       | 341.02    | 0.51      | 0.73     | 0.2772       | 0:00:10      | 58.67         | 92.41        | 67.08      | 0.78       | 0.92      | 0.0979        | 0:00:16       | 0:21:18    |
| 1     | 0.07502    | 54.52         | 92.18        | 0.2341        | 0:00:12       | 34.29        | 95.32       | 348.40    | 0.51      | 0.73     | 0.2885       | 0:00:10      | 59.48         | 92.54        | 67.14      | 0.78       | 0.92      | 0.0979        | 0:00:16       | 0:21:22    |
| 2     | 0.07363    | 54.81         | 92.21        | 0.2342        | 0:00:12       | 34.16        | 95.34       | 338.97    | 0.51      | 0.73     | 0.2865       | 0:00:10      | 59.64         | 92.55        | 65.14      | 0.79       | 0.92      | 0.0970        | 0:00:16       | 0:21:32    |
| 3     | 0.07254    | 54.89         | 92.22        | 0.2355        | 0:00:11       | 34.51        | 95.47       | 346.29    | 0.51      | 0.73     | 0.2982       | 0:00:10      | 59.80         | 92.58        | 64.94      | 0.79       | 0.92      | 0.0973        | 0:00:16       | 0:21:14    |
| 4     | 0.07216    | 54.88         | 92.21        | 0.2362        | 0:00:12       | 34.53        | 95.44       | 333.97    | 0.51      | 0.73     | 0.2883       | 0:00:10      | 59.89         | 92.60        | 64.76      | 0.79       | 0.92      | 0.0971        | 0:00:16       | 0:21:17    |
