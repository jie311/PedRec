# PedRecNet2D
## Trial Name
**experiment_pedrec_p2d3d_c_o_h36m_sim**
## Initialization
| Network Part                   | Initialization                                               |
| ------------------------------ | ------------------------------------------------------------ |
| net.model.feature_extractor    | TODO                                                         |
| net.model.conv_transpose_shared | TODO                                                         |
| net.model.head_pose_2d         | TODO                                                         |
| net.model.head_pose_3d         | TODO                                                         |
| net.model.head_orientation     | TODO                                                         |
| net.model.head_conf            | TODO                                                         |
Notes. Initialized from p2d3d_c_h36m_sim
## Datasets
### Training
| Dataset                   | Subsampling | Full set length | Used length |
| ------------------------- | ----------- | --------------- | ----------- |
| COCO (TRAIN)              | 1           | 149813          | 149813      |
| rt_rom_01b.pkl            | 1           | 147729          | 147729      |
| rt_validate_3d.pkl        | 1           | 39484           | 39484       |
| h36m_train_pedrec.pkl     | 10          | 155976          | 155976      |
### Validation
| Dataset                   | Subsampling | Full set length | Used length |
| ------------------------- | ----------- | --------------- | ----------- |
| COCO (VAL)                | 1           | 6352            | 6352        |
| rt_validate_3d.pkl        | 10          | 3949            | 3949        |
| h36m_val_pedrec.pkl       | 64          | 8604            | 8604        |
## Augmentation
### Training Augmentations - COCO
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 30                        |
### Training Augmentations - SIM
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 0                         |
### Training Augmentations - H36M
| Augmentation              | Value                     |
| ------------------------- | ------------------------- |
| Scale                     | 0.25                      |
| Flip                      | True                      |
| Rotate                    | 0                         |
## General data preparation
```python
trans = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
])
```
suggested lr: 2.08e-03
## Round 0
- Epochs: **10**
- LR Scheduler: **OneCycleLR**
### Optimizer
| Property                  | Value                     |
| ------------------------- | ------------------------- |
| name                      | AdamW                     |
| lr                        | 0.001                     |
| betas                     | (0.9, 0.999)              |
| eps                       | 1e-08                     |
| weight_decay              | 0.01                      |
| amsgrad                   | False                     |
### LRs
| Network Part              | LRs                  | Frozen? |
| ------------------------- | -------------------- | ------- |
| net.model.feature_extractor | 2.08e-03, 2.08e-03   | True    |
| net.model.conv_transpose_shared | 2.08e-03, 2.08e-03   | False   |
| net.model.head_pose_2d    | 2.08e-03, 2.08e-03   | False   |
| net.model.head_pose_3d    | 2.08e-03, 2.08e-03   | False   |
| net.model.head_orientation | 2.08e-03, 2.08e-03   | False   |
| net.model.head_conf       | 2.08e-03, 2.08e-03   | False   |
### Results
| Epoch | Train Loss | COCO PCK@0.05 | COCO PCK@0.2 | COCO JointAcc | COCO Body Sph.Dist. | COCO Body.Phi.Ang.Dist. | COCO Head Sph.Dist. | COCO Head.Phi.Ang.Dist. | COCO Val Loss | COCO Val Time | SIM PCK@0.05 | SIM PCK@0.2 | SIM MPJPE | SIM MRCJP | SIM MRCD | SIM JointAcc | SIM Body Sph.Dist. | SIM Body.Phi.Ang.Dist. | SIM Head Sph.Dist. | SIM Head.Phi.Ang.Dist. | SIM Val Loss | SIM Val Time | H36M PCK@0.05 | H36M PCK@0.2 | H36M MPJPE | H36M MRCJP | H36M MRCD | H36M JointAcc | H36M Val Loss | H36M Val Time | Train Time |
| ----- | ---------- | ------------- | ------------ | ------------- | ------------------- | ----------------------- | ------------------- | ----------------------- | ------------- | ------------- | ------------ | ----------- | --------- | --------- | -------- | ------------ | ------------------ | ---------------------- | ------------------ | ---------------------- | ------------ | ------------ | ------------- | ------------ | ---------- | ---------- | --------- | ------------- | ------------- | ------------- | ---------- |
| 0     | 1.06266    | 53.07         | 91.73        | 0.88          | 0.00                | 0.26                    | 0.00                | 0.00                    | 0.6353        | 0:00:12       | 92.13        | 99.97       | 23.52     | 0.81      | 0.93     | 1.00         | 0.12               | 0.12                   | 0.18               | 0.16                   | 0.1417       | 0:00:11      | 60.16         | 92.49        | 65.22      | 0.79       | 0.92      | 1.00          | 0.1429        | 0:00:17       | 0:31:11    |
| 1     | 0.15869    | 52.92         | 91.80        | 0.87          | 0.00                | 0.29                    | 0.00                | 0.00                    | 0.6739        | 0:00:11       | 92.03        | 99.97       | 25.23     | 0.80      | 0.92     | 1.00         | 0.18               | 0.18                   | 0.21               | 0.19                   | 0.1181       | 0:00:10      | 60.54         | 92.49        | 65.81      | 0.79       | 0.92      | 1.00          | 0.1461        | 0:00:16       | 0:30:44    |
| 2     | 0.16913    | 53.07         | 91.75        | 0.87          | 0.00                | 0.31                    | 0.00                | 0.00                    | 0.6838        | 0:00:12       | 92.15        | 99.97       | 25.45     | 0.80      | 0.93     | 1.00         | 0.17               | 0.18                   | 0.20               | 0.19                   | 0.1152       | 0:00:11      | 59.39         | 92.33        | 67.04      | 0.79       | 0.92      | 1.00          | 0.1496        | 0:00:17       | 0:30:28    |
| 3     | 0.16893    | 52.95         | 91.81        | 0.86          | 0.00                | 0.34                    | 0.00                | 0.00                    | 0.7100        | 0:00:12       | 92.56        | 99.97       | 24.04     | 0.80      | 0.92     | 1.00         | 0.17               | 0.17                   | 0.29               | 0.28                   | 0.1221       | 0:00:10      | 60.03         | 92.51        | 66.66      | 0.79       | 0.92      | 1.00          | 0.1488        | 0:00:16       | 0:31:46    |
| 4     | 0.16376    | 53.01         | 91.80        | 0.87          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.6620        | 0:00:12       | 93.33        | 99.97       | 23.37     | 0.81      | 0.93     | 1.00         | 0.12               | 0.12                   | 0.21               | 0.21                   | 0.1094       | 0:00:10      | 59.65         | 92.53        | 65.10      | 0.79       | 0.92      | 1.00          | 0.1472        | 0:00:16       | 0:31:11    |
| 5     | 0.15657    | 53.33         | 91.79        | 0.88          | 0.00                | 0.30                    | 0.00                | 0.00                    | 0.6520        | 0:00:12       | 93.58        | 99.96       | 21.92     | 0.82      | 0.94     | 1.00         | 0.13               | 0.13                   | 0.14               | 0.13                   | 0.1023       | 0:00:10      | 59.83         | 92.52        | 65.77      | 0.79       | 0.92      | 1.00          | 0.1458        | 0:00:16       | 0:31:16    |
| 6     | 0.14779    | 53.38         | 91.83        | 0.88          | 0.00                | 0.29                    | 0.00                | 0.00                    | 0.6373        | 0:00:12       | 94.48        | 99.97       | 20.86     | 0.83      | 0.94     | 1.00         | 0.12               | 0.12                   | 0.11               | 0.10                   | 0.0949       | 0:00:11      | 60.22         | 92.49        | 65.02      | 0.79       | 0.92      | 1.00          | 0.1448        | 0:00:16       | 0:29:48    |
| 7     | 0.13982    | 53.24         | 91.87        | 0.89          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.6284        | 0:00:12       | 94.64        | 99.98       | 19.98     | 0.84      | 0.94     | 1.00         | 0.10               | 0.10                   | 0.09               | 0.08                   | 0.0898       | 0:00:10      | 60.73         | 92.59        | 65.35      | 0.79       | 0.92      | 1.00          | 0.1444        | 0:00:16       | 0:29:54    |
| 8     | 0.13484    | 53.35         | 91.88        | 0.89          | 0.00                | 0.29                    | 0.00                | 0.00                    | 0.6266        | 0:00:11       | 94.82        | 99.98       | 19.35     | 0.84      | 0.95     | 1.00         | 0.09               | 0.09                   | 0.08               | 0.07                   | 0.0871       | 0:00:10      | 60.80         | 92.60        | 64.50      | 0.79       | 0.92      | 1.00          | 0.1427        | 0:00:16       | 0:29:42    |
| 9     | 0.13259    | 53.30         | 91.85        | 0.89          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.6247        | 0:00:11       | 94.90        | 99.98       | 19.15     | 0.84      | 0.95     | 1.00         | 0.09               | 0.09                   | 0.08               | 0.07                   | 0.0866       | 0:00:10      | 60.84         | 92.61        | 64.54      | 0.79       | 0.92      | 1.00          | 0.1430        | 0:00:16       | 0:29:39    |
## Round 1
- Epochs: **5**
- LR Scheduler: **OneCycleLR**
### Optimizer
| Property                  | Value                     |
| ------------------------- | ------------------------- |
| name                      | AdamW                     |
| lr                        | 0.001                     |
| betas                     | (0.9, 0.999)              |
| eps                       | 1e-08                     |
| weight_decay              | 0.01                      |
| amsgrad                   | False                     |
### LRs
| Network Part              | LRs                  | Frozen? |
| ------------------------- | -------------------- | ------- |
| net.model.feature_extractor | 1.04e-04, 1.04e-04   | False   |
| net.model.conv_transpose_shared | 2.08e-04, 2.08e-04   | False   |
| net.model.head_pose_2d    | 2.08e-04, 2.08e-04   | False   |
| net.model.head_pose_3d    | 2.08e-04, 2.08e-04   | False   |
| net.model.head_orientation | 2.08e-04, 2.08e-04   | False   |
| net.model.head_conf       | 2.08e-04, 2.08e-04   | False   |
### Results
| Epoch | Train Loss | COCO PCK@0.05 | COCO PCK@0.2 | COCO JointAcc | COCO Body Sph.Dist. | COCO Body.Phi.Ang.Dist. | COCO Head Sph.Dist. | COCO Head.Phi.Ang.Dist. | COCO Val Loss | COCO Val Time | SIM PCK@0.05 | SIM PCK@0.2 | SIM MPJPE | SIM MRCJP | SIM MRCD | SIM JointAcc | SIM Body Sph.Dist. | SIM Body.Phi.Ang.Dist. | SIM Head Sph.Dist. | SIM Head.Phi.Ang.Dist. | SIM Val Loss | SIM Val Time | H36M PCK@0.05 | H36M PCK@0.2 | H36M MPJPE | H36M MRCJP | H36M MRCD | H36M JointAcc | H36M Val Loss | H36M Val Time | Train Time |
| ----- | ---------- | ------------- | ------------ | ------------- | ------------------- | ----------------------- | ------------------- | ----------------------- | ------------- | ------------- | ------------ | ----------- | --------- | --------- | -------- | ------------ | ------------------ | ---------------------- | ------------------ | ---------------------- | ------------ | ------------ | ------------- | ------------ | ---------- | ---------- | --------- | ------------- | ------------- | ------------- | ---------- |
| 0     | 0.13269    | 53.26         | 91.62        | 0.89          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.6283        | 0:00:11       | 94.79        | 99.98       | 19.67     | 0.84      | 0.94     | 1.00         | 0.10               | 0.09                   | 0.08               | 0.07                   | 0.0876       | 0:00:10      | 60.33         | 92.56        | 65.03      | 0.79       | 0.92      | 1.00          | 0.1439        | 0:00:16       | 0:34:50    |
| 1     | 0.13379    | 53.17         | 91.60        | 0.89          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.6269        | 0:00:11       | 95.01        | 99.98       | 19.30     | 0.84      | 0.94     | 1.00         | 0.10               | 0.10                   | 0.07               | 0.07                   | 0.0861       | 0:00:10      | 60.47         | 92.57        | 65.80      | 0.79       | 0.92      | 1.00          | 0.1433        | 0:00:16       | 0:34:52    |
| 2     | 0.13139    | 53.25         | 91.62        | 0.89          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.6252        | 0:00:12       | 95.40        | 99.99       | 18.49     | 0.84      | 0.95     | 1.00         | 0.09               | 0.09                   | 0.07               | 0.07                   | 0.0837       | 0:00:10      | 60.86         | 92.58        | 65.20      | 0.79       | 0.92      | 1.00          | 0.1431        | 0:00:16       | 0:35:47    |
| 3     | 0.12780    | 53.29         | 91.67        | 0.89          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.6234        | 0:00:13       | 95.61        | 99.99       | 17.91     | 0.85      | 0.95     | 1.00         | 0.08               | 0.08                   | 0.06               | 0.06                   | 0.0812       | 0:00:11      | 60.99         | 92.57        | 64.86      | 0.79       | 0.92      | 1.00          | 0.1434        | 0:00:17       | 0:36:01    |
| 4     | 0.12606    | 53.30         | 91.68        | 0.89          | 0.00                | 0.28                    | 0.00                | 0.00                    | 0.6231        | 0:00:12       | 95.73        | 99.99       | 17.69     | 0.85      | 0.95     | 1.00         | 0.08               | 0.08                   | 0.06               | 0.06                   | 0.0807       | 0:00:10      | 60.95         | 92.62        | 64.50      | 0.79       | 0.92      | 1.00          | 0.1432        | 0:00:17       | 0:35:33    |
